import{j as e,c as a,e as o,d as c,A as n,u as x}from"./index-07b8d0e5.js";import{u as d}from"./user-e932d91f.js";import{d as m}from"./dayjs.min-b9add960.js";import{u}from"./useQuery-f292ed8c.js";function f({src:t,name:l,email:s}){return e.jsxs("div",{className:"relative w-2/5 h-full max-w-[600px]",children:[e.jsx("div",{className:"max-w-[550px] rounded-xl h-full overflow-hidden",children:e.jsx("img",{src:t,alt:"profile image",className:"w-full h-full aspect-auto object-cover blur-md"})}),e.jsxs("div",{className:"absolute inset-0 m-auto flex flex-col justify-center items-center",children:[e.jsx("img",{src:t,alt:"profile image",className:"block w-20 h-20 rounded-full border-[2px] border-white drop-shadow-lg"}),e.jsx("p",{className:"font-bold text-2xl pt-4",children:l}),e.jsx("p",{children:s})]})]})}const h=async t=>{try{const l=await a({url:"/mypage?role=USER",method:"GET",headers:{Authorization:t}});return l.data.data?l.data.data:null}catch(l){return console.info(l),null}};function i({type:t,ticket:l}){const s={rest:{src:"/dots.svg",alt:"dots image",title:"남은 티켓",ticketStyle:"text-3xl font-bold text-main",imageStyle:"w-12 h-12 my-auto"},used:{src:"/user.svg",alt:"user image",title:"사용한 티켓",ticketStyle:"text-3xl font-bold text-point",imageStyle:"w-12 h-12 my-auto"}};return e.jsxs("div",{className:"flex border-[1px] mx-4 py-2 px-8 rounded-2xl",children:[e.jsx("img",{className:s[t].imageStyle,src:s[t].src,alt:s[t].alt}),e.jsxs("div",{className:"flex flex-col items-center py-2 px-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-2xl px-4",children:s[t].title}),e.jsx("div",{className:s[t].ticketStyle,children:l})]})]})}function p({data:t}){const l={ACCEPT:"bg-confirm",REFUSE:"bg-point",WAITING:"bg-wait"};return e.jsxs("div",{className:"flex items-center mb-4 bg-boxbg px-4 py-2 rounded-xl",children:[e.jsx("p",{className:"flex-1 font-bold truncate",children:t.title}),e.jsx("p",{className:"mr-4 text-[0.9rem]",children:m(t.scheduleStart).format(o)}),e.jsx("span",{className:`${l[t.progress]} w-[80px] text-center text-white 
        truncate lowercase font-bold  px-2 rounded-full`,children:t.progress})]})}function j({data:t}){var l;return e.jsx("ul",{children:(l=t.schedulerRoleUserList)==null?void 0:l.map(s=>e.jsx(p,{data:s},s.scheduleStart))})}function g({user:t}){const[l]=c([n]),{data:s,isSuccess:r}=u(["myTicketList",t.id?t.id:""],()=>h(l.AccessToken),{staleTime:1e3*60*5});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:r&&s&&e.jsxs(e.Fragment,{children:[e.jsx(i,{type:"used",ticket:s==null?void 0:s.getUserInfoDTO.usedTicket}),e.jsx(i,{type:"rest",ticket:s==null?void 0:s.getUserInfoDTO.sizeOfTicket})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold pt-20",children:"나의 티켓 리스트"}),e.jsxs("div",{className:"border-[1px] p-4 mt-4 rounded-2xl max-h-[500px] overflow-y-scroll scrollbar-hide",children:[r&&s&&e.jsx(j,{data:s}),r&&!s&&e.jsxs("div",{className:"relative flex justify-center h-full min-h-[20rem]",children:[e.jsx("h2",{className:"text-2xl font-bold p-5",children:"예약된 정보가 없습니다!"}),e.jsx("img",{className:"absolute inset-0 m-auto opacity-20",src:"/YeonganIdolLogoOrigin.svg",alt:"Yeongan Idol's Logo"})]})]})]})]})}function w(){const t=x(),{getUserInfo:l}=d(),s=l();if(s.role!=="USER"){alert("관리자는 접근할 수 없는 페이지입니다."),t("/login");return}return e.jsxs("div",{className:"flex flex-col ml-4 p-4 h-screen",children:[e.jsx("h1",{className:"text-3xl font-bold border-b-2 pb-2",children:"티켓 신청 내역"}),e.jsxs("div",{className:"flex h-full pt-8",children:[e.jsx(f,{src:s.profileImage,name:s.fullName,email:s.email}),e.jsx("div",{className:"w-3/5 ml-8",children:e.jsx(g,{user:s})})]})]})}export{w as default};
